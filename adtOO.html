<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script>

function forEachIn(object, action) {
  for (var property in object) {
  if (Object.prototype.hasOwnProperty.call(object, property))
    action(property, object[property]);
  }
}
function forEach(array, action) {
  for (var i = 0; i < array.length; i++)
    action(array[i]);
}
function shuffle(array) {
  var tmp, current, top = array.length;
  if(top) while(--top) {
    current = Math.floor(Math.random() * (top + 1));
    tmp = array[current];
    array[current] = array[top];
    array[top] = tmp;
  }
  return array;
}

function evenSpread(){
  isEven = false;
  return isEven;
}

console.log("hello");
// method invocation pattern - however mixing data and methdos looks likely to cause problems
var questions = {
  /*[0]topic: [statements[0]...statements[N]],*/
  0: [ 'sopranos','the wire','breaking bad', 'game of thrones', 'fargo','pokemon','match of the day','community','oz','penny dreadful'],
  1: ['blade runner', 'godfather','goodfellas', 'king kong', 'star wars', 'star trek', 'serenity', 'primer','blues brothers', 'taxi driver'],
  2: ['dublin', 'london', 'new york', 'brighton', 'glasgow', 'galway','cork','kildare','maynooth', 'goldsmiths'],
  3 : ['ronaldo','messi','suarez','pele','andy murray','roy mcelroy','barack obama','sepp blater','david cameron','tony blair'],
  4: ['glastonbury', 'world cup', 'wimbledon', 'election', 'wedding', 'holiday', 'baptism', 'christening','funeral', 'finale'],
  5: ['we3', 'gravitys rainbow', 'chaos', 'ubiq','sandman','invisibles','transmetropolitan','watchmen','lord of the rings','2666'],
  6: ['refrigerator', 'a.i.', 'neon', 'vinyl', 'tv', 'radio', 'telegraph', 'telephone', 'film', 'engine'],
  7: ['beef', 'noodles', 'pizza', 'rice', 'pasta', 'potatoes', 'chips', 'fries', 'tortilla', 'nachos'],
  8: ['youtube','gmail','internet','twitter','facebook','flickr','linkedin','tumblr','yahoo','pornhub'],
  9: ['range-rover', 'toyota','nissan','suzuki','volvo','volkswagen','mini','bmw','ford','mazda']
};

function QuizContent(qs) {
  this.questions = qs;
}

// below maybe needs inclusion

// QuizContent.prototype.evenSpread = function(){
//   isEven = false;
//   return isEven;
// }

QuizContent.prototype.count = function(subjects) {
  // returns a hash object of statement number : number of entitites in array
  var totalTopics = Object.keys(this.questions).length;
  var cnt = [];
  forEachIn(this.questions, function(k,v){
    var obj = {};
    l=v.length;
    obj.contents = l;
    obj.ref = parseInt(k);
    cnt.push(obj);
  });
  return cnt;
}

QuizContent.prototype.chooseFive = function(topic) {
    var object = this.questions; // a copy should suffice given changes not made until remove
    var genObj = {};
    for (var c = 0; c < topic.length; c++){
      var l = (object[topic[c]].length)-1;
      // fetch the length of the array from which a random element is to be chosen
      genObj[topic[c]] = Math.floor((Math.random() * l));
    }
    return genObj;
};
QuizContent.prototype.presentStatements = function(nuArray,microObject) {
  var object = this.questions; // a copy should suffice given changes not made until remove
  forEachIn(microObject, function(k,v){
    nuArray.push(object[k][v]);
  });
  return(nuArray);
};

QuizContent.prototype.remove = function(microObject) {
  forEachIn(microObject, function(k,v){
    this.questions[k].splice(v, 1);
  });
};

// somewhere between above and below needs to be the edge case of No Statements Left!
sortDesc = function(aList){
  // aList will typically will be the returned array from count
  topics = []; // empty topics necessary so that an array of objects is not returned
  console.log("within TopicPool "+typeof aList);
  if (evenSpread(aList)) {
    console.log("no need to prioritise!");
  } else {
    nuOrder = aList.sort(function(a,b){return a.contents - b.contents});
  }
  nuOrder = nuOrder.reverse(); // we are interested in the highest counts, so the reverse method is requisite
  forEach(nuOrder, function(a){
    topics.push(a.ref);
  });
  return topics;
}


console.log("goodbye");
    var thirtySeconds = new QuizContent(questions);
    console.log(thirtySeconds);
    var topicTally = thirtySeconds.count();
    console.log(topicTally);
    var round1 = sortDesc(topicTally).slice(0,5);
    console.log(round1);
    var first = thirtySeconds.chooseFive(round1);
    console.log(first);
    thirtySeconds.remove(first);
    console.log(thirtySeconds.presentStatements([],first));
    topicTally = thirtySeconds.count();
    console.log(topicTally);
  // for (var c = 0; c < 5; c++) {
    // var topicTally = shuffle(count(thirtySeconds));
    // var round1 = sortDesc(topicTally).slice(0,5); // round1 is an array of topic indexes
    // var first = chooseFive(round1,thirtySeconds);
    // remove(first,thirtySeconds);
    // console.log(presentStatements([],first,thirtySeconds)); // present statements 
    // topicTally = count(thirtySeconds);
    // var round2 = sortDesc(topicTally).slice(0,5);
    // var flip = chooseFive(round2,thirtySeconds);
    // console.log("...");
    // console.log(presentStatements([],flip,thirtySeconds));
    // remove(flip,thirtySeconds);
  // }



</script>
</html>