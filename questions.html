<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script>

function forEachIn(object, action) {
	for (var property in object) {
	if (Object.prototype.hasOwnProperty.call(object, property))
		action(property, object[property]);
	}
}
function forEach(array, action) {
  for (var i = 0; i < array.length; i++)
    action(array[i]);
}
console.log("hello");
// method invocation pattern - however mixing data and methdos looks likely to cause problems
var questions = {
	/*[0]topic: [statements[0]...statements[N]],*/
	0: [ 'sopranos','the wire','breaking bad', 'game of thrones', 'fargo','pokemon','match of the day','community','oz','penny dreadful'],
	1: ['blade runner', 'godfather','goodfellas', 'king kong', 'star wars', 'star trek', 'serenity', 'primer','blues brothers', 'taxi driver'],
	2: ['dublin', 'london', 'new york', 'brighton', 'glasgow', 'galway','cork','kildare','maynooth', 'goldsmiths'],
	3 : ['ronaldo','messi','suarez','pele','andy murray','roy mcelroy','barack obama','sepp blater','david cameron','tony blair'],
	4: ['glastonbury', 'world cup', 'wimbledon', 'election', 'wedding', 'holiday', 'baptism', 'christening','funeral', 'finale'],
	5: ['we3', 'gravitys rainbow', 'chaos', 'ubiq','sandman','invisibles','transmetropolitan','watchmen','lord of the rings','2666'],
	6: ['refrigerator', 'a.i.', 'neon', 'vinyl', 'tv', 'radio', 'telegraph', 'telephone', 'film', 'engine'],
	7: ['beef', 'noodles', 'pizza', 'rice', 'pasta', 'potatoes', 'chips', 'fries', 'tortilla', 'nachos'],
	8: ['youtube','gmail','internet','twitter','facebook','flickr','linkedin','tumblr','yahoo','pornhub'],
	9: ['range-rover', 'toyota','nissan','suzuki','volvo','volkswagen','mini','bmw','ford','mazda']
	// to test sorting algorithm, there follows some deliberately diminished arrays
	// 10: ['just the one'],
	// 11: ['a','b','c','d','e','f','g','h','i','j','k','l'],
	// 12: ['m','n','o','p','q','r','s','t','u','v','w','x','y','z'],
	// 13: ['Lorem', 'ipsum', 'dolor', 'sit', 'amet', 'audire', 'forensibus', 'ut', 'his', 'cum']
	/*[N]topic: [statements[0]...statements[N]] */
};
count = function(subjects) {
	// returns a hash object of statement number : number of entitites in array
	var totalTopics = Object.keys(subjects).length;
	var cnt = [];
	//var itr = 0;
	//cnt['total'] = 0;
	forEachIn(subjects, function(k,v){
		var obj = {};
		l=v.length;
		//obj[k] = l;
		obj.contents = l;
		obj.ref = parseInt(k); // this toInt explication might be unnecessary, given how Object keys functioned in testadt
		cnt.push(obj);
		//cnt['total']+=l;
	});
	return cnt;
}

evenSpread = function(count){
// determine whether every statement array in questions is even or not
// this function could be bundled into count object

// count object revised into array of objects, below commented out until efficacy establish
isEven = false;
	// console.log("within EvenSpread "+typeof count);
	// var isEven = false;
	// var total = 0;
	// forEachIn(count, function(k,v){total+=v;});
	// var mean = Math.ceil(total/(Object.keys(count).length));
	// console.log("total = "+total+" mean = "+mean);

	// forEachIn(count, function(k,v){
	// 	if(v<mean){
	// 		console.log("should be seeing this if lower "+v);
	// 		isEven = false;
	// 		mean = v;
	// 	} else if (v===mean) {
	// 		console.log("wtf?"+v);
	// 		isEven = true;
	// 	}
	// });

	return isEven;
}
// somewhere between above and below needs to be the edge case of No Statements Left!
sortDesc = function(aList){
	// returns an array of objects, sorted in priority of which object has the most statements remaining
	// objects = {
	// 	contents:
	// 	ref: 
	// }
	console.log("within TopicPool "+typeof aList);
	if (evenSpread(aList)) {
		console.log("no need to prioritise!");
	} else {
		nuOrder = aList.sort(function(a,b){return a.contents - b.contents});
	}
	return nuOrder.reverse(); // we are interested in the highest counts, so the reverse method is requisite
}

function chooseFive(topic, object) {

		var genObj = {};
		for (var c = 0; c < topic.length; c++){
			var l = (object[topic[c]].length)-1;
			// fetch the length of the array from which a random element is to be chosen
			genObj[topic[c]] = Math.floor((Math.random() * l));
		}
		return genObj;
};

function presentStatements(nuArray,microObject, object) {
	forEachIn(microObject, function(k,v){
		nuArray.push(object[k][v]);
	});
	return(nuArray);
};

function remove(microObject, object) {
	forEachIn(microObject, function(k,v){
		object[k].splice(v, 1);
	});
};

console.log("goodbye");

var num = count(questions);
var topFive = sortDesc(num).slice(0,5);
console.log(topFive);

forEach(topFive, function(a){console.log(a.ref);});

</script>
</html>