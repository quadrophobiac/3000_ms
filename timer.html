<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/tr/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
<head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="author" content="Jason Chavannes" />
    <title>jQuery Timer Demo</title>
    
   <!--  <link rel="stylesheet" href="res/style.css" /> -->
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="jquery.timer.js"></script>
    <!-- <script type="text/javascript" src="res/demo.js"></script> -->
    <script type="text/javascript">
        function pad(number, length) {
            var str = '' + number;
            while (str.length < length) {str = '0' + str;}
            return str;
        }
        function formatTime(time) {
            // this function can be rewritten per the parameters desired to be achieved
            var min = parseInt(time / 6000),
                sec = parseInt(time / 100) - (min * 60),
                hundredths = pad(time - (sec * 100) - (min * 6000), 2);
            return (min > 0 ? pad(min, 2) : "00") + ":" + pad(sec, 2) + ":" + hundredths;
        }

            // the structure below appears to be a module alike entity
            // it is hiding several functions from outside access / inspection
            // the function is wrapped in ( ) which means its self invoking, or that it is triggered immediately like most jQuery things
            // what's new here is that all the vars are listed comma seperated, and once a ; is placed after a var, all subsequent vars
            // ^^ this MAY be a quirk of jQuery
            // with a 'this.' assignment can be looked at from outside
            // the countdown var assigned through a public init has different properties, it only has access to context, instead of a zero indexed spanElement when called via $countdown
            // when init is called outside the constructor via this. assignment it only has access to HTML document object, rather than span element

        var ThurtySeconds = new function() { // I have here amended from self invoking, and called init() outside
            var $countdown,
                $form, // Form used to change the countdown time
                incrementTime = 70,
                currentTime = 3000,
                updateTimer = function() {
                    console.log(currentTime);
                    console.log($countdown);
                    console.log(formatTime(currentTime));
                    // countdown returns object HTMLSpanElement
                    // $countdown returns object Object, but when init is public, said object lacks span context
                    // $countdown.html returns a function
                    $countdown.html(formatTime(currentTime)); // this function is purely for visual feedback
                    // $countdown.html("<br>HELLO"); has no effect
                    if (currentTime == 0) {
                        ThurtySeconds.Timer.stop();
                        timerComplete();
                        ThurtySeconds.resetCountdown();
                        return;
                    }
                    // the below handles the business of counting down
                    currentTime -= incrementTime / 10;
                    if (currentTime < 0) currentTime = 0;
                },
                timerComplete = function() {
                    alert('YOUR TURNS OVER! SCORE = ');
                    // goof place for the remove flip logic
                };

                this.init = function() {
                    console.log($countdown);
                    $countdown = $('#countdown');
                    console.log($countdown);
                    ThurtySeconds.Timer = $.timer(updateTimer, incrementTime, false);
                    $form = $('#ThurtySeconds');
                    $form.bind('submit', function() {
                        ThurtySeconds.resetCountdown();
                        return false;
                    });
                };
            this.resetCountdown = function() {
                //var newTime = parseInt($form.find('input[type=text]').val()) * 100; // if changing manually
                var newTime = 300;
                console.log(newTime);
                if (newTime > 0) {currentTime = newTime;}
                this.Timer.stop().once();
            };
        //$(init); // doesn't appear to be an easy way to invoke this outside of the object
        };

        $( document ).ready(function(){
        ThurtySeconds.init();
        });

    </script>
</head>
<body>


    <h3>Example 2 - Countdown Timer</h3>
    <span id="countdown">00:30:00</span>
    <form id="ThurtySeconds">
        <input type='button' value='Play/Pause' onclick='ThurtySeconds.Timer.toggle();' /> <!-- init function creates the Timer object-->
        <input type='button' value='Stop/Reset' onclick='ThurtySeconds.resetCountdown();' />
        <!-- <input type='text' name='startTime' value='300' style='width:30px;' /> -->
    </form>

</body>
</html>